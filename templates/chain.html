{% extends "base.html" %}

{% block content %}
<div class="blockchain-bg">
    <div class="row">
        <div class="col-12">
            <div class="card h-100">
                <div class="card-header text-white" style="background: linear-gradient(45deg, #6c5ce7, #a29bfe);">
                    <h4 class="mb-0">
                        <i class="fas fa-link me-2"></i>
                        Blockchain Data
                    </h4>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card bg-dark text-white">
                                <div class="card-body">
                                    <h6 class="mb-2 text-secondary">
                                        <i class="fas fa-cube me-2"></i>
                                        Chain Length
                                    </h6>
                                    <h3 class="mb-0">{{length}}</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-dark text-white">
                                <div class="card-body">
                                    <h6 class="mb-2 text-secondary">
                                        <i class="fas fa-network-wired me-2"></i>
                                        Connected Peers
                                    </h6>
                                    <h3 class="mb-0">{{peers|length}}</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-dark text-white">
                                <div class="card-body">
                                    <h6 class="mb-2 text-secondary">
                                        <i class="fas fa-vote-yea me-2"></i>
                                        Total Transactions
                                    </h6>
                                    <h3 class="mb-0">{{total_transactions}}</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chain-blocks">
                        {% for block in chain %}
                        <div class="card mb-3 bg-dark text-white">
                            <div class="card-header border-bottom border-secondary d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge bg-primary me-2">Block #{{block.index}}</span>
                                    <small class="text-secondary">
                                        <i class="fas fa-clock me-1"></i>
                                        {{block.timestamp|timestamp}}
                                    </small>
                                </div>
                                <div>
                                    <span class="badge bg-secondary">
                                        <i class="fas fa-dice me-1"></i>
                                        Nonce: {{block.nonce}}
                                    </span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-12">
                                        <label class="text-secondary mb-1">Previous Hash</label>
                                        <div class="hash-container">
                                            <code class="hash">{{block.previous_hash}}</code>
                                        </div>
                                    </div>
                                </div>
                                {% if block.transactions %}
                                <div class="table-responsive">
                                    <table class="table table-dark table-hover">
                                        <thead>
                                            <tr>
                                                <th>Voter ID</th>
                                                <th>Party</th>
                                                <th>Time</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for tx in block.transactions %}
                                            <tr>
                                                <td><code>{{tx.voter_id}}</code></td>
                                                <td>
                                                    <span class="badge bg-primary">{{tx.party}}</span>
                                                </td>
                                                <td>
                                                    <small>{{tx.timestamp|timestamp}}</small>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                                {% else %}
                                <div class="text-center text-secondary">
                                    <i class="fas fa-cube me-2"></i>
                                    Genesis Block
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.hash-container {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    padding: 0.5rem 1rem;
    overflow-x: auto;
    white-space: nowrap;
}

.hash {
    color: #a29bfe;
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 0.9rem;
}

.chain-blocks {
    max-height: 800px;
    overflow-y: auto;
    padding-right: 10px;
}

.chain-blocks::-webkit-scrollbar {
    width: 8px;
}

.chain-blocks::-webkit-scrollbar-track {
    background: var(--bg-secondary);
    border-radius: 4px;
}

.chain-blocks::-webkit-scrollbar-thumb {
    background: linear-gradient(45deg, #6c5ce7, #a29bfe);
    border-radius: 4px;
}

.chain-blocks::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(45deg, #a29bfe, #6c5ce7);
}

.table-dark {
    background-color: transparent;
    color: var(--text-primary);
}

.table-dark td, .table-dark th {
    border-color: rgba(255, 255, 255, 0.1);
}

.table-hover tbody tr:hover {
    background-color: rgba(108, 92, 231, 0.1);
}
</style>
{% endblock %}
